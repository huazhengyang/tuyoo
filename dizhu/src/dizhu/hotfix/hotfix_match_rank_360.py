# -*- coding:utf-8 -*-
'''
Created on 2017年11月22日

@author: wangyonghui
'''
import json

from dizhu.entity.matchhistory import saveMatchHistoryRank
from poker.entity.dao import userdata
import time
import datetime

userList_20171021_6304 = (20171021, 6304, [81922120,283217510,77996876,233754179,278633318,253159106,104291055,16734971,269283147,123681036,267852085,45442490,146545144,257686293,165954986,15680801,105386384,263433056,136581848,267575651,149500245,268707228,147261121,256224405,120644471,279298528,278712741,274944385,260904281,88795975,279927650,243559372,237277181,271190877,4156514,279422343,236676885,283783901,250332304,131830432,95439598,233057753,256668613,257326592,118382662,252833690,281029845,103877613,156470923,278605977,119342286,56986092,195672218,39476136,264599522,113692278,280372307,255334314,44705895,67088475,264409295,187822351,237390201,71874956,273491925,37682597,265412435,96014504,273619357,225788685,276390934,111420299,259672357,254589984,101707969,214588871,158081902,277314479,283703011,239691943,267230775,272469898,117010951,279125713,126644792,197308703,264747745,272491409,279196321,270103214,133321505,257826086,177975369,178955600,282493640,281057571,283767659,187709326,257527677,283262568,271437972,163681171,183407217,279455002,101841947,92046647,263582434,78788332,192365988,264583018,200611427,261333276,254438276,32276060,191958577,164928006,116114726,225795344,37402832,95745534,267397611,261945510,177031132,278718286,139130267,268718598,256784096,199611071,97592253,257899245,275261092,228412259,68085867,249942430,255248412,58684287,165395067,223583792,234086114,11644447,77453526,238801024,161395834,275933158,185124742,278193280,263827203,281557343,72901226,265414100,73611383,265065521,276285412,254223941,38857485,157955500,279798086,161844774,277880253,101172328,136987116,266879778,68699782,90293879,83344474,215771759,103215163,271300272,263106003,150127531,280237492,127829567,230812085,145748528,189616138,263735069,281412752,264089082,35705975,279487728,31866980,133728074,273423674,282304603,263786284,265295512,259286229,283032270,219624879,174808913,89253734,283438916,115560198,255523134,36156214,144090651,85229200,111561614,137078771,203096675,240757665,107057043,214119870,251417432,281701511,254710055,118403834,13326962,235616755,270713013,275525909,96215106,135829234,159068844,209411280,175787814,14234971,231606866,221223925,120416752,36968639,202377868,282019026,281580870,269723848,33927173,263896357,146274586,178836109,282282987,114184409,276252641,277325942,159337178,72530516,19381759,174288427,201115871,253454499,212253836,74764699,229617970,266101183,263072337,38803642,271918434,118159956,271273557,245616695,241880432,280250855,129542551,177561338,257967768,98345565,101448354,191873932,113508068,226402489,79755272,244565994,205998502,283597322,177258888,282561764,165289724,281897562,281736551,279574774,119638530,270965383,272343046,215005110,110700773,97814786,131533311,238357075,279423349,180221891,260196294,199243479,162826974,41121146,278235850,147902617,131404123,267954617,255999543,67687372,36088405,204883223,77427201,281595185,217865530,83508846,155662156,130137039,281441780,139443017,215431081,35907728,261556129,133366807,227286869,107455696,134907330,283015074,233836722,277916571,278864368,269624096,221884090,222049956,121984680,280840410,157445752,279894549,270838503,254705656,82789495,277062943,235775225,280033129,83193851,139976660,253624863,242348103,267320384,193204491])
userList_20171022_6304 = (20171022, 6304, [110561160,93490881,19381759,250047253,72901226,162041940,283015784,139613771,262277582,261945510,79420966,58096247,146793987,78236971,180221891,242000469,219481043,278211583,136644487,218048871,159068844,281891106,251248014,267397611,114189394,283217510,265461906,267229016,233754179,248228164,275261092,74456896,279539870,276656747,176823920,63842351,196153992,217865530,225651373,37273817,155910917,267819604,114184409,283658133,254589984,226444833,267607224,235375267,246087865,272281925,227287322,36068933,277367367,137908920,121233205,32214034,269375648,281081902,282203409,150297931,130937037,161064135,280237492,150127531,58855702,161395834,283667142,201015725,118668590,192702801,131533311,228862311,143981845,283262568,273924317,142697165,103973210,134907330,283173282,257686293,239443588,283008322,256224405,276197787,234382168,281712807,257029959,202377868,58684287,86011351,263947710,266322366,280957020,115560198,283694874,156383512,280084252,1431275,118382662,281602245,256231329,174557721,278613356,267055441,130137039,241723041,277177071,257527677,165869071,278095925,272756959,199226611,93506189,250181494,237277181,283620623,72444970,225795344,123681036,275933158,261199109,117010951,249656882,276252641,234086114,107057043,282508510,274944385,77453526,277578146,38482005,72108813,254011228,254710055,257806335,205998502,80728419,255685125,271016196,277916571,120975231,281057571,204883223,280049109,266836576,158670410,136987116,207038349,197078091,283154523,225686743,135178231,279631891,123983014,39476136,169688102,265765196,282193041,280423752,265613067,268211048,234957364,278235850,281177803,271674725,178955600,221223925,229248231,278864368,267145000,268707228,226755269,197308703,180595586,263433056,275438163,31866980,74764699,277880253,147902617,278718286,126644792,282815350,270103214,199611071,278193280,266453976,61302434,280224860,77089337,149572429,257822684,281595185,281334578,272719193,267230775,163137560,280675694,116114726,139976660,254674659,283493830,276285412,277270237,168627896,80572260,261629682,102898615,38734148,121396693,263827203,18525311,257899245,282971161,283601030,157602264,211400352,101448354,248496664,127829567,113508068,232895750,262628103,280870125,266649255,281898493,36156214,118739285,282809636,135611898,271131362,281515841,103215163,121432165,253159106,282271324,79754924,270838503,142271639,271587175,162826974,282493087,56058769,273651032,214843157,214959876,234643355,162835013,194202265,273428543,66582874,88722858,148888606,166382716,107389524,15680801,121984680,280279407,255413535,179121686,150730798,109496410,38862987,178219341,262412635,188281492,229624388,259672357,169057632,268546843,278341965,264409295,248402258,106020154,148883944,282969766,52865130,177975369,191038840,264638575,61866845,276676141,256827739,254546606,266879778,111557868,94716263,236676885,245014922,131149167,265751797,118159956,225269454,150154238,255999543,280262040,149827549,265414100,279574774,268046017,182007630,280588146,210799396,277062943,214588871,36088405,280245276,276064694,255688704,256596154,283497212,156470923,124933680,111532988,278536077,276544887,265896946,262539879,142458042,38745614,277878397,280372307,242348103,77427201,143324800,258276596,256618069,263466853])
userList_20171028_6304 = (20171028, 6304, [276959721,276676141,110719749,281709357,254223941,90894406,191375375,41708948,36068933,72153850,177014841,281441780,101140548,221116014,266196140,267902276,203438650,263912411,234086114,101661423,257392850,82148032,234684786,116114726,234643355,145119944,197440357,239332712,284287078,97592253,276568053,281854210,283422692,283409051,272110754,215431081,237043340,281029845,90165108,194725895,72235050,280262040,34006534,107057043,275716876,282163014,267295336,259488018,228147992,171033868,189885206,261833583,101707969,79038560,161844774,165954986,270535281,282271324,136987116,132443520,136581848,89253734,114184409,245014922,225321473,98804048,131830432,135041141,264409295,282493640,147902617,260904281,78430445,283783901,220993994,152982227,136704250,266005004,253454499,255846693,225004951,36014286,281081902,283457575,121233205,268823333,86655573,262977132,263786284,222757386,277367367,263896357,77996876,266722800,278037538,179121686,254710055,284540469,161064135,281878293,170240828,276223387,177975369,208087092,119020121,223583792,262984653,270912591,121282599,114189394,215771759,280062059,191896172,241730601,272512638,262539879,152387089,181032164,82763357,19381759,275554296,278456448,241373402,235815373,127927632,191456192,278711934,256231329,209084640,88324280,140336681,192213742,174064886,202377868,65355330,156804661,180060011,281334578,130137039,248626101,87069998,255737092,153177806,201416181,257134067,39167921,135611898,124933680,275099050,257899245,142271639,218090143,96014504,254011228,281397533,120975231,254546606,18525311,119771865,266249872,272671826,84740596,98989804,275067510,226876149,237470483,280844301,161304809,107455696,213670853,88318096,281324085,282787706,112383371,118217641,89857615,239180597,273423674,184897311,263075650,83555672,133440817,284163218,133728074,283032270,259672357,276369077,225269454,280849081,227789778,277963537,277253427,101354185,280777392,279631891,41212851,233131107,275608857,146545144,277888759,263827203,155910917,206543573,123237713,182007630,268513514,279539870,45817931,256668613,275004525,269653627,39476136,135280622,282381294,265461906,14234971,281557343,56610734,281581596,280111449,97205096,148565880,252833690,159337178,178955600,271066670,282888376,214959876,209411280,175787814,254589984,128557300,241880432,256618069,97985128,269353382,104772559,230875404,283296201,102081191,110491914,190515313,38710938,36968639,281412752,282059950,127680025,36998793,273838322,83344474,284684855,284540356,279700785,251531656,231426455,252084336,20388596,235603595,282439115,38857485,271190877,139976660,279298528,263713457,282100451,133321505,156515200,86775736,139547851,64970223,260834717,274654994,131149167,279290791,255999543,284128230,275634233,132025937,266453976,199715681,88722858,81922120,115326540,272756959,187031060,40461327,275771080,254705656,93347986,35705975,86011351,237098023,112018880,271131362,262412635,282493087])
userList_20171029_6304 = (20171029, 6304, [103973210,183407217,83344474,267575651,98180189,215643472,234684786,191958577,281324085,97205096,159463578,139813438,159337178,82789495,88324280,50105242,32575457,176823920,280881067,254589984,192213742,274389866,121282599,83067013,273423674,262977132,284892194,133728074,153177806,229248231,278536077,265461906,279290791,234398571,105429459,282493087,163335541,279010984,259283798,36209973,36963699,281029845,89857615,111648310,195038351,275933158,280062059,116114726,66582874,114184409,259526920,149198237,270444086,282019026,211400352,266005004,77427201,274157902,267644185,151993303,89253734,191122876,79038560,254008173,249070633,149834312,272963720,271697750,224155227,281897562,268046017,245619072,237043340,219490888,268718598,260904281,31866980,255999543,156515200,276879554,274991984,219624879,101354185,271188500,281890534,120975231,101140548,172388103,267930503,215055339,162826974,269375648,283244131,96014504,180221891,169253904,283422692,215337012,175787814,103215163,280777392,284774258,223902724,152387089,225795344,162261981,280661431,282744883,124842980,268955113,275716876,169057632,282282987,267229016,274944385,148883944,154356749,41121146,270906459,178219341,92498919,196426622,275177805,236485994,87069998,199257737,254438276,266879778,150127531,36968639,225004951,110095638,233742817,116249164,152980192,273535243,169555089,88745041,71264221,256618069,277214517,191375375,284162201,242498703,174557721,161844774,90894406,258779848,233810521,284278022,284856643,220993994,38710938,58684287,273924317,132443520,39476136,103877613,139976660,247648712,262539879,255586825,234086114,206543573,277170759,254223941,259672357,114189394,155819124,261522476,140336681,252833690,210642080,279298528,234822492,266160780,250181494,282846625,56986092,257822684,267397611,254066861,249203965,194975533,276369077,263466853,145423475,72977243,277253427,111956283,86067313,274654994,213655388,245014922,263896357,35705975,227287322,253454499,128085380,269922264,143981845,105577117,177014841,150181754,111420299,276593336,217865530,284737621,120644471,32276060,257686293,242002274,239097872,257899245,98989804,207038349,267440340,39167921,199715681,201387275,283409051,155452205,157955500,39242488,282380267,153079557,229617970,260196294,107057043,272032581,131830432,150154238,265765196,225321473,280262040,254674659,282203409,208087092,67687372,222757386,255846693,188820629,83550901,75836299,254710055,186399010,257658769,272989686,191038840,283768885,78145304,236676885,246537309,249656882,201015725,81900977,58855702,221223925,67749777,146545144,282772036,264760091,239443588,131149167,145670525,282271324,98384750,116076916,264993541,280269096,146793987,63208168,277584872,174064886,268823333,259403334,268546843,272783198,270535281,275119991,284687086,108108706,279423349,34006534,275300928,188114313,109406172,281578845,277916571,199225120,111557868,281024366,269222776,194725895,225686743,100745341,81948982])
userList_20171031_6305 = (20171031, 6305, [221116014,263896357,282846625,276369077,155910917,206543573,265412435,39476136,101140548,36968639,159068844,38745614,58855702,105429459,1431275,72153850,14234971,233742817,107455696,240757665,250181494,181032164,281177803,82789495,233754179,265065521,159337178,223583792,194202265,82763357,257822684,93347986,95745534,245014922,81948982,214119870,268823333,31866980,269922264,82148032,146545144,159463578,89857615,98345565,147902617,246087865,282019026,269353382,131149167,118382662,265295512,178955600,255737092,98804048,126644792,83067013,103215163,260904281,279290791,195038351,273423674,272783198,149834312,279631891,155819124,150127531,176823920,148883944,276252641,214588871,187709326,180221891,136704250,283457575,218090143,275261092,272989686,121282599,180595586,248626101,262412635,266160780,281712807,165954986,133728074,277062943,255846693,238801024,225795344,284540356,264409295,174557721,257029959,276285412,124842980,131533311,192365988,191873932,281057571,265414100,133321505,88722858,268707228,267607224,157955500,77453526,239180597,262977132,234086114,128557300,130137039,275716876,150297931,266649255,156515200,225321473,276656747,199243479,184897311,275067510,38710938,230812085,263466853,193204491,270906459,267230775,229617970,194725895,18525311,207038349,123681036,191375375,156470923,253454499,161844774,39167921,36156214,282282987,276064694,209084640,177014841,284774258,132443520,268546843,259283798,145748528,89253734,256596154,252833690,282381294,225004951,131830432,281029845,274991984,101661423,152387089,283422692,83193851,71874956,257806335,255523134,163335541,187822351,274944385,227287322,265461906,281602245,156804661,280237492,281334578,255334314,158670410,92498919,88324280,256668613,274654994,151993303,275177805,107057043,254710055,41121146,261522476,38862987,276223387,277878397,32575457,256231329,169555089,19381759,135611898,276568053,93506189,38734148,254438276,120975231,223902724,281897562,177258888,279298528,263072337,272110754,257826086,78788332,280033129,194975533,257899245,98989804,183407217,121432165,279422343,282304603,281024366,249656882,281397533,40461327,236676885,255999543,116114726,11644447,220993994,41708948])
userList_20171104_6304 = (20171104, 6304, [223974872,89738693,257822684,116114726,280444267,283181378,156994529,280269096,285568809,263095597,229999771,281334578,282864378,121282599,275361133,160313992,284326648,230812085,281412752,72901226,237377358,257527677,145748528,177014841,88722858,248626101,88242659,255556707,14234971,188960108,275177805,283457575,95745534,271605780,278633318,264760091,90894406,72153850,273423674,153481041,234398571,272680344,279125713,267192444,230535370,283409381,263553703,131533311,277244755,219481043,106352903,268928360,282143062,283493830,270535281,222757386,207038349,280464965,242186241,262399362,285334911,142542493,234709888,122502270,169394207,90293879,113508068,152701480,270920706,285488322,257806335,116388603,255290432,206543573,270135852,268718598,41212851,118217641,136581848,282856996,201015725,158663135,107057043,279010984,151994404,280659957,223583792,284938234,5376351,239443588,58303576,96215106,277333597,38787367,88324280,283133263,272989686,214588871,269375648,272861490,254223941,279290791,283262568,165289724,284965486,263877500,35907728,233754179,71874956,135611898,285831224,285792521,265461906,225321473,159068844,275562671,137771565,139795746,261368700,131149167,150503466,256618069,285491155,13183121,254589984,235484468,139636211,92501659,267653343,169026063,13326962,267883996,242348103,200043062,172716489,217682304,280230953,256596154,268707228,285191786,241959383,227696582,215771759,100381383,220993994,105429459,248228164,215643472,237098023,222231354,257819914,124095639,260904281,273433113,251390724,199225120,184897311,265613067,270426975,175268338,133728074,283130058,282271324,259283798,217992152,266196140,272467125,89857615,144055622,281029845,234643355,285332014,272110754,192213742,197157764,280777392,161395834,242473654,285399860,37402832,146274586,243445748,230217285,101140548,282203409,258626832,205839170,61206668,191129000,266740871,147902617,79281878,251531656,270960655,161844774,282239113,222328023,174447893,276567796,259382707,40410316,210888819,178955600,88837927,117132925,268495552,285711740,174865995,97592253,282493087,242002274,209876950,99913003,278654480,40750409,159463578,285436982,161064135,148888606,264747745,11644447,244745602,264993541,218090143,190515313,171033868,195038351,156515200,118739285,38857485,279298528,39476136,262105818,284272430,254710055,148639265,139637729,204130251,225788091,285485780,6216659,283997847,159695005,276369077,254875217,82763357,181032164,101689371,283705104,237470483,240096911,109638195,283768885,227285677,152650634,268046017,281057571,133366807,202377868,180221891,102083016,55891871,118159956,143981845,118403834,239473305,214843157,268823333,145670525,267320384,263320147,239379289,273533999,101354185,36007565,265412435,112018880,284933672,224370770,271352929,280917751,36955302,221252969,80546572,273818402,114189394,82787624,157955500,221661061,95576407,276154929,119545279,273880224,219624879])
userList_20171105_6304 = (20171105, 6304, [161844774,231109653,280464965,58735835,149827549,266592021,283409051,98180189,254546606,84902055,263679031,283181378,82148032,151994404,255523134,148883944,279422343,187355264,255601483,281465836,159337178,92501659,174447893,170240828,122502270,181032164,283420826,270713013,282143062,38745614,284446246,238801024,83782397,67445354,180595586,283457575,219624879,72153850,276369077,281897562,177014841,227739790,249070633,283173282,14234971,63842351,166661235,285263229,274593001,142307716,193359491,237043340,278654480,78677677,276593336,89253734,187368061,133728074,145423475,194202265,100381383,280777392,95576407,89857615,271697750,109253805,234086114,281602245,121282599,224240840,269922264,112383371,39287806,118668590,260196294,172444851,179037936,209876950,224580534,136644487,159695005,79175190,117961335,260368609,258999435,283997847,56058769,266005004,191038840,275223129,248626101,76366263,36209973,257527677,116114726,271131362,177561338,110257478,13183121,282282987,281712807,283444951,142866575,269283147,87069998,76324143,271273557,281837339,74418217,39242488,262412635,50082285,281067201,159068844,129055613,86679391,225321473,230432920,221116014,264638575,237427282,227789778,280423752,276959721,284880803,20388596,271066670,38277009,280262040,223583792,119545279,34006534,136146790,41821804,184897311,173757392,243445748,120776032,75477818,217714297,38787367,38857485,103796952,46407967,210890469,278604321,178955600,280691940,120975231,264993541,257911843,199225120,213706209,139831940,285457534,228147992,284532151,31866980,253354250,262670563,196483161,265893438,114189394,254710055,237377358,223916444,218090143,265765196,200006420,278633318,152701480,74764699,36968639,269923404,191375375,192213742,75864841,266568018,272110754,222495688,263553703,276458009,41212851,275261092,66047697,156804661,258276596,282382494,9531974,71433475,152223152,13326962,201015725,172992395,273423674,261242685,118403834,176823920,128557300,204920362,278711934,79038560,155452205,285710523,222757386,282963161,282791400,48835804,268046017,113508068,262105818,36156214,268495552,284131265,98384750,239473305,164971513,82893503,268546843,83818050,174064886,116388603,199681502,157955500,271188500,83344474,276252641,281611810,223902724,231349436,284759634,261368700,153079557,242207859,165147853,207625170,283148863,247376062,44705895,140336681,211931098,245014922,108209246,74010276,82056885,210642245,285833655,209411280,222328023,77089337,236453751,39476136,277888759,269787716,104142342,36088405,274157902,213839561,285668841,79755272,261199109,143636035,145809027,285236272,145670525,284933672,232895750,227146574,122061868,143981845,105429459,254223941,215771759,285485780,135757013,271686219,109406172,139547851,218247255,252833690,257029959,98734104,207038349,280182991,242348103,206543573,223656182,285675034,88722858,270535281,279833495,269324143,90411717,195160024,283479502,237032311,264760091,242498703,271912705,163938512,78311462,254589984,264089082,258268259,281537883,213266595,161395834,277270237,112018880,41121146,281324085,261522476,257596976,263715507,270906459,84740596,266771914,191456192,281436640,212481006])
userList_20171111_6304 = (20171111, 6304, [252833690,140336681,263264937,233326130,283416757,271352929,252850040,169687348,128557300,235185313,218090143,258276596,87892362,214171223,285263229,265371888,276567796,279643930,254011228,209411280,266453976,88795975,36007565,206543573,110491914,239473305,118217641,194975533,286699941,67687372,244933270,267599164,229617970,180595586,208087092,72901226,119567246,275886034,282079265,272989686,280763558,281712807,156041803,148888606,285593201,240002069,267855858,270713013,271131362,257686293,217992152,146896948,79536634,102898615,271016196,101658937,276568053,268495552,273619357,40814142,214959876,79175190,116017409,94174963,89857615,282600051,283608754,285706713,131533311,262105818,132025937,237277181,282370586,177975369,285510408,109638195,272076448,72848747,260553659,278864368,162041940,82148032,230432920,139442885,273610368,116114726,145670525,78236971,225321473,280636182,161844774,38277009,263095597,130809726,131830432,177478377,153602288,224370770,283037793,40554957,269923404,107455696,38745614,179037936,191024853,285904829,101656353,267653343,281673998,156783233,132724733,219481043,90165108,251908874,286501818,41821804,98137285,276166878,279290791,282621096,266118733,168971835,280402018,285335684,180221891,180060011,48777104,263827203,97831823,230812085,264338357,274277169,95745534,101841947,66582874,259728116,218545591,284540356,190760642,107450194,254223941,273433113,151337607,278981777,277805948,211484592,237470483,87069998,181032164,122502270,156804661,38857485,48453838,250664550,177014841,207786318,107193872,76834913,36156214,31866980,127998184,270627179,159337178,276258944,264863271,184897311,184731471,83344474,271300272,231394272,285399860,259623962,161064135,194202265,250681712,254871778,222757386,281709357,194170208,38862987,5998566,225795344,86877461,269723848,40417813,145219140,280898052,270426975,245001023,118407210,175787814,18525311,174557721,280777392,121282599,229188104,275177805,135611898,264638575,89502581,282493087,233272531,126311347,37250269,268046017,280464965,275261092,130137039,117132925,241319815,277253427,263553703,93533880,129188566,215643472,113508068,143981845,168579294,134853275,111060642,275067510,277177071,81463730,30575621,72235050,285210609,215442204,248228164,286059738,101354185,178955600,220559104,284710853,156657573,263308994,114189394,284236229,136146790,265124627,281619114,285547009,152387089,268658044,274849510,233131107,281602245,286305132,200333544,279631891,229248231,264011368,153481041,102755808,107057043,141178564,157110394,270897076,192365988,223583792,176823920,237098023,281385977,279125713,41708948,243187940,280812364,261526956,118403834,195038351,199257737,262787234,197440357,89831586,265765196,219624879,46407967,211931098,103215163,262888531,179121686,216466847,139547851,261177504,264409295,171596347,267229016,88324280,267930503,253454499,282023075,205233768])
userList_20171112_6304 = (20171112, 6304, [36068933,236688611,267653343,265065521,279829432,36968639,278711934,178955600,273423674,279125713,217865530,111532988,276437029,224851504,150154238,280366515,206543573,285172915,264409295,231109653,274593001,233131107,268495552,242186241,285593201,225321473,286070465,180221891,132086724,214959876,108209246,242002274,271352929,148888606,273619357,209876950,109063830,36156214,279411191,286688598,255290432,262412635,266740871,136251795,264338357,274669219,119567246,130137039,34006534,39476136,282378705,92501659,281984512,137005501,272602559,251516608,279833495,257527677,270319500,114189394,200043062,157445752,280464965,239097872,151994404,282019026,27892664,1431275,270965383,79755272,285568809,271016196,210799396,83784916,13326962,278864366,263735069,213706209,143702802,229188104,116114726,219939814,234859689,226599050,284337298,212340768,280955525,67088475,273807909,58684287,191896172,185078685,82148032,267607224,284272430,89857615,278604321,274934767,285750204,278605977,264863271,274157902,72236604,40410316,261465430,271300272,72901226,234825588,254705656,286003880,236970321,170240828,9531974,285502009,268718598,150954421,277972467,281334578,254589984,37273817,279010339,159337178,239379289,199715681,157239977,98137285,254223941,276369077,103656638,285547009,275160143,43913383,121282599,276568053,174064886,136581848,225795344,38277009,268123602,209177552,198689951,269923404,177039627,175787814,241855928,263095597,224370770,245619072,205264768,248496664,99913003,254710055,239443588,226040639,217682304,207625170,215442204,244933270,283037793,278082965,75227399,126311347,83286349,266549624,195160024,196483161,14234971,284540356,285007593,133728074,139267614,273818402,266118733,237112021,242047531,234643355,207624631,67445354,277878397,145670525,140336681,210890469,255999543,282085951,240691597,281131207,38710938,153177806,282282987,233742817,264897240,279829416,277888759,266593879,272220185,286830973,272110754,196704122,48208616,262899306,279290791,46407967,285737504,133908453,163963610,283497212,254011228,229617970,260553659,110491914,282503654,267013289,192175631,87069998,228393999,265613067,191456192,39020909,284532151,75127652,264651852,263786284,269787716,119863486,286679779,93347986,6216659,179037936,152701480,190760642,286767119,206408605,200037752,146545144,84740596,180060011,261177504,221116014,211393452,204115561,261587603,31866980,146793987,252059901,283623020,234086114,286253074,79038560,286866672,77089337,223583792,255523134,194725895,183407217,270444086,261629682,280262040,260461475,157110394,142542493,237277181,279643930,262539879,5376351,284131265,237098023,98384750,161395834,148883944,238770616,137771565,279544363,260970776,94174963,120975231,265709831,180595586,237941322,177014841,234684786,50082285,282143062,276001080,38862987,286832440,272282300,278498106,97477292,72153850,281204065,78236971,209411280,152650634,285332014,280033129,159068844,36088405,135501163,65555102,286325431,286228676,277030875,131084222,155819124,205233768,273258741,281736551,285288157])
userList_20171118_6304 = (20171118, 6304, [147790138,114189394,146545144,270960655,280100372,48441133,82253018,90165108,38277009,103215163,279419865,195038351,281204065,54730796,14234971,273459305,282493640,284532151,157955500,210890469,268495552,38857485,277062943,256410819,110491914,286917727,253779475,237453931,268791303,179037936,116114726,72236604,269923404,285230994,136581848,140336681,280062059,178955600,282605770,283623020,268836775,254705656,263896357,40814142,257527677,274991984,77745605,235775225,260421699,283997847,215771759,272602559,233204061,257826086,108271966,281328799,285222080,275177805,92498919,138772169,270444086,107057043,18999009,152701480,225321473,220559104,274826288,100814525,285601588,286433826,281456943,219624879,71414066,281712807,194586467,42001386,83344474,206408605,255737092,148883944,260553659,269729789,168579294,281557343,144890168,224155227,285155961,69085530,89857615,284362883,121133746,270722193,282203409,281701511,204883223,284558611,81671641,116329994,199611071,282600051,273423674,120776032,150954421,39020909,209568006,269353382,277511387,260904281,270321026,273619357,279181375,193359491,276369077,261368923,159337178,60476483,233742817,281334578,265310728,259283798,264599522,281602245,86067313,128085380,136644487,227146574,230875404,151384771,98804048,274701917,86595254,258276596,255601483,278633318,84573811,202377868,23965483,260772391,98384750,234643355,277324301,98345565,159463578,151695108,223902724,262273443,36088405,281709357,148565880,139442885,263095597,173757392,109406172,179048426,251390724,212340768,277270237,180595586,133728074,287590216,263308994,88324280,211251909,199225120,97477292,105386384,228412259,143981845,227398742,287248907,250268169,93969025,169555089,108108706,224461474,224370770,132786991,285399860,283608754,130867366,269717756,156515200,155819124,287295466,244933270,280262040,265435434,286055442,225795344,276568053,147261121,214466907,170159448,282924691,242207859,285917418,278985392,36968639,88722858,245014922,177039627,257890099,71663880,195160024,285488819,100428727,271352929,277030875,38710938,265561877,249656882,263466853,78236971,31866980,137078771,269324143,276252641,229248231,137908920,277946044,284863600,155109931,222757386,234709888,58855702,233131107,154146184,283768885,175426568,228147992,275562671,88745041,189885206,156041803,285457534,126311347,150297931,285547009,152980192,133908453,284958094,265709831,268046017,252139679,249578823,194725895,130809726,103555663,264338357,259795338,276544011,163178976,281024366,254589984,86886536,176823920,272978507,191456192,96657503,130755968,145670525,284909152,122502270,262105818,121282599,142542493,230120407,281897562,239691943,270535281,276567796,273433113,271131362,278864366,155943673,284711921,285788173,42029548,161395834,280366515,248626101])
userList_20171119_6304 = (20171119, 6304, [275177805,144890168,131533311,277062943,276258944,279422343,281334578,255737092,287295466,83231051,83555672,91583045,176823920,281897562,286797352,35861801,287521095,76148836,268046017,223583792,265461906,89502581,36007565,251876210,206543573,269419442,153079557,135660785,127781446,148883944,277688200,175787814,262888531,44452726,152650634,148888606,285547009,249203965,123602597,39090927,205233768,173757392,194202265,82148032,283296201,287933214,260904281,111294344,269729789,214466907,285363013,281204065,265561877,130137039,174447893,200333544,101354185,269246865,118403834,132086724,282605770,263308994,35861052,284756674,72901226,287775316,149589927,284958094,260539909,143944017,254011228,245001023,274934767,234425217,286784127,242047531,93533880,263466853,287497348,263896357,271352929,230120407,285155961,105126759,256214928,31866980,271300272,276568053,278066151,245014922,278604321,252084336,270768453,118217641,58684287,217588753,256671305,86679391,287502151,117010951,218247255,273459305,194975533,191503693,39390977,4156514,156994529,284326648,140336681,103215163,71874956,136885438,75772948,169394207,137771565,165954986,262412635,135611898,284532151,276729625,270535281,180595586,92498919,280366515,275119991,117665817,84573811,286164111,280262040,226599050,200043062,254308075,139976660,286505526,78114504,155417595,153177806,268123602,32575457,67445354,97039608,50082285,38710938,263095597,285740612,134907330,257822684,146274586,36156214,259283798,227146574,202492898,283997847,105386384,256110064,209876950,79714503,83344474,79094708,120766703,70314708,161844774,58303576,229188104,63415016,235775225,135608828,257029959,199242982,236676885,259623962,210890469,285737336,139267614,136644487,272989686,123466197,82633403,139130267,27892664,260030531,222283280,287411310,274826288,149645220,263679031,263877500,260553659,63842351,178955600,267954617,256227032,225709402,38277009,168034102,254589984,287180873,71663880,72235050,273619357,277575215,129542551,98414528,241283292,243884244,272602559,287882197,107057043,219624879,275687034,287225890,213706209,157445752,273423674,284362883,278483856,256875161,284880803,277986872,268495552,213726148,282726458,277916571,197157764,100814525,287199262,282369742,285457534,260156128,282924691,234709888,280636182,63123078,243885432,224240840,225788091,89253734,133728074,250664550,114189394,242540450,142542493,36068933,261755805,39132668,58855702,143048882,281214200,254223941,263433056,223703860,274593001,128085380,285230994,230432920,252833690,225321473,191456192,274701917,181032164,279036834,124095639,242002274,192365988,78271109,77461722,84740596,278864366,279798086,282489926,214959876,286795838,281602245,226303197,276369077,155943673,222757386,193585140,94723445,261945510,157955500,286789514,93969025,266160780,86886536,285904829,148565880,284077923,197440357,88242659,194725895,285599618,233272531,139012925,130809726,108209246,276458009,239738089,111420299,224804869,285568809,98384750,258999435,149852778,261177504,187368061,254705656,104698869,175426568,245619072,284540356,177561338,254546606,79175190,65555102,269283147,89857615,45442490,73611383,133908453,100293067,249979963,281673998,145670525,260461475,150632394,260421699,280777392,189650936,121282599,152515559,285396087,137078771,139547851,282539762])
match_user_list = [userList_20171021_6304, userList_20171022_6304, userList_20171028_6304, userList_20171029_6304,
                   userList_20171031_6305, userList_20171104_6304, userList_20171105_6304, userList_20171111_6304,
                   userList_20171112_6304, userList_20171118_6304, userList_20171119_6304]

# 测试用数据
# userList_20171021_6304 = (20171104, 6304, [10002, 10003, 1, 10001, 2, 3])
#
# userList_20171022_6304 = (20171105, 6304, [2, 10002, 10003, 1, 3, 10001])
#
# userList_20171028_6304 = (20171111, 6304, [3, 10001, 10002, 10003, 1, 2])
#
# userList_20171029_6304 = (20171112, 6304, [10002, 10003, 1, 2, 10001, 3])
#
# userList_20171031_6305 = (20171031, 6305, [10001, 10002, 10003, 1, 2, 3])
# match_user_list = [userList_20171021_6304, userList_20171022_6304, userList_20171028_6304, userList_20171029_6304, userList_20171031_6305]


for matchDate, matchId, userList in match_user_list:
    rankList = []
    info = None
    for rank, userId in enumerate(userList, 1):
        name, purl = userdata.getAttrs(userId, ['name', 'purl'])
        info = {
            'name': str(name),
            'purl': purl,
            'userId': userId,
            'rewardsDesc': '',
            'rank': rank,
            'timestamp': int(time.mktime(datetime.datetime.strptime(str(matchDate), "%Y%m%d").timetuple()))
        }
        info = json.dumps(info)
        rankList.append(info)
        rankList.append(rank)
    saveMatchHistoryRank(matchId, str(matchDate), json.dumps([rankList]))
